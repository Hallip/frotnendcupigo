/** 	=========================
	Template Name 	 : Dating Kit
	Author			 : DexignZone
	Version			 : 1.0
	File Name		 : custom.js
	Author Portfolio : https://themeforest.net/user/dexignzone/portfolio

	Core script to handle the entire theme and core functions
**/

$(document).ready(function () {
  var e,
    a,
    s,
    o = !1,
    t = 0,
    c = jQuery(".demo__card").length,
    i = 0,
    d = 0,
    l = 0;
  function n() {
    ++t === c && ((t = 0), $(".demo__card").removeClass("below"));
  }
  $(document).on(
    "mousedown touchstart",
    ".demo__card:not(.inactive)",
    function (t) {
      if (!o) {
        (e = $(this)),
          (a = $(".demo__card__choice.m--reject", e)),
          (s = $(".demo__card__choice.m--like", e)),
          ($cardSuperLike = $(".demo__card__choice.m--superlike", e));
		  var c = t.pageX || (t.originalEvent.touches ? t.originalEvent.touches[0].pageX : 0),
		  r = t.pageY || (t.originalEvent.touches ? t.originalEvent.touches[0].pageY : 0);	  
        $(document).on("mousemove touchmove", function (t) {
          var n,
            u,
            p,
            m,
            g,
            f = t.pageX || (t.originalEvent.touches ? t.originalEvent.touches[0].pageX : 0),
    		v = t.pageY || (t.originalEvent.touches ? t.originalEvent.touches[0].pageY : 0);

          //console.log("Y-" + v),
            //console.log("startY-" + r),
            (i = f - c),
            (d = r - v),
            //console.log("pullDeltaX->" + i),
            (i || d) &&
              ((o = !0),
              (l = i / 10),
              (degY = d / 10),
              (n = !1),
              Math.abs(d) > Math.abs(i) && (n = !0),
              n
                ? e.css("transform", "translateY(-" + d + "px)")
                : e.css(
                    "transform",
                    "translateX(" + i + "px) rotate(" + l + "deg)"
                  ),
              //console.log("pullDeltaY->" + d),
              (u = i / 100),
              (p = d / 100),
              //console.log("opacityY->" + p),
              (m = u <= 0 ? 0 : u),
              //console.log("likeOpacity--" + m),
              (g = p <= 0 ? 0 : p),
              //console.log("superlikeOpacity-" + g),
              a.css("opacity", u >= 0 ? 0 : Math.abs(u)),
              s.css("opacity", m),
              n && $cardSuperLike.css("opacity", g));
        }),
		$(document).on("mouseup touchend", function () {
			$(document).off("mousemove touchmove mouseup touchend");
			var profileId = e.data('profile-id'); // Suponemos que cada .demo__card tiene un atributo 'data-id' para identificar el perfil
		
			if (Math.abs(i) < Math.abs(d)) {
				if (d >= 80) {
					e.addClass("to-upside");
					onSwipe(profileId, 'like'); // Aquí llamamos a la función cuando el swipe es hacia arriba
				} else if (d <= -80) {
					e.addClass("to-downside");
					onSwipe(profileId, 'dislike'); // Aquí llamamos a la función cuando el swipe es hacia abajo
				}
		
				if (Math.abs(d) >= 80) {
					e.addClass("inactive");
					setTimeout(function () {
						e.addClass("below").removeClass("inactive to-upside to-downside");
						n();
					}, 300);
				}
		
				if (Math.abs(d) < 80) {
					e.addClass("reset");
				}
		
				setTimeout(function () {
					e.attr("style", "").removeClass("reset").find(".demo__card__choice").attr("style", "");
					d = 0;
					o = !1;
				}, 300);
			} else if (Math.abs(i) > 0) {
				if (i >= 80) {
					e.addClass("to-right");
					onSwipe(profileId, 'like'); // Aquí llamamos a la función cuando el swipe es a la derecha
				} else if (i <= -80) {
					e.addClass("to-left");
					onSwipe(profileId, 'dislike'); // Aquí llamamos a la función cuando el swipe es a la izquierda
				}
		
				if (Math.abs(i) >= 80) {
					e.addClass("inactive");
					setTimeout(function () {
						e.addClass("below").removeClass("inactive to-left to-right");
						n();
					}, 300);
				}
		
				if (Math.abs(i) < 80) {
					e.addClass("reset");
				}
		
				setTimeout(function () {
					e.attr("style", "").removeClass("reset").find(".demo__card__choice").attr("style", "");
					i = 0;
					o = !1;
				}, 300);
			}
		});		
      }
    }
  ),
    jQuery(".dz-sp-like").on("click", function () {
      var e = jQuery(this).parents(".demo__card"),
        a = e.find(".demo__card__choice.m--superlike");
      a.css("opacity", "1"),
        e.slideUp(300, function () {
          n(),
            setTimeout(function () {
              e.addClass("below").css("display", ""), a.css("opacity", "");
            }, 500);
        });
    });
});